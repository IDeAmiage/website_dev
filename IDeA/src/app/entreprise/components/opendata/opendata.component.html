<div *ngIf="this.loader.isLoading | async" class="loader-container">
  <mat-spinner style="top: 50%; left: 50%;"></mat-spinner>
</div>

<div class="grid-container">
  <h1 class="mat-h1">Opendata</h1>
  <mat-form-field appearance="fill">
    <mat-label>Select an category</mat-label>
    <mat-select [(value)]="selected">
      <mat-option value="all">None</mat-option>
      <mat-option value="sante">Santé</mat-option>
      <mat-option value="transport">Transport</mat-option>
      <mat-option value="environnement">Environnement</mat-option>
    </mat-select>
  </mat-form-field>
  
  <div *ngIf="selected==='environnement'">
    <h2>Trie par catégorie environnement</h2>
    <mat-grid-list cols="4">
      <mat-grid-tile *ngFor="let card of listeEnvironment" [colspan]=1 [rowspan]=1>
        <mat-card class="dashboard-card">
          <mat-card-header>
            <mat-card-title>
              {{card.fields.dataset_id}}
              <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu" xPosition="before">
                <button mat-menu-item>Expand</button>
                <button mat-menu-item>Remove</button>
              </mat-menu>
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="dashboard-card-content">
            <div>Number of records: {{card.fields.records_count}}</div>
            <div>Size of records: {{card.fields.records_size}}</div>
            <div>Last measure: {{card.fields.data_processed}}</div>
            <button mat-icon-button class="data-button" (click)="this.showTable(this.card.fields.dataset_id)"
              routerLink="table">
              <mat-icon>description</mat-icon>
            </button>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
    </mat-grid-list>
  </div>
  <div *ngIf="selected==='sante'">
    <h2>Trie par catégorie Santé</h2>
    <mat-grid-list cols="4">
      <mat-grid-tile *ngFor="let card of listeSante" [colspan]=1 [rowspan]=1>
        <mat-card class="dashboard-card">
          <mat-card-header>
            <mat-card-title>
              {{card.fields.dataset_id}}
              <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu" xPosition="before">
                <button mat-menu-item>Expand</button>
                <button mat-menu-item>Remove</button>
              </mat-menu>
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="dashboard-card-content">
            <div>Number of records: {{card.fields.records_count}}</div>
            <div>Size of records: {{card.fields.records_size}}</div>
            <div>Last measure: {{card.fields.data_processed}}</div>
            <button mat-icon-button class="data-button" (click)="this.showTable(this.card.fields.dataset_id)"
              routerLink="table">
              <mat-icon>description</mat-icon>
            </button>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
    </mat-grid-list>
  </div>
  <div *ngIf="selected==='transport'">
    <h2>Trie par catégorie transport</h2>
    <mat-grid-list cols="4">
      <mat-grid-tile *ngFor="let card of listeTransport" [colspan]=1 [rowspan]=1>
        <mat-card class="dashboard-card">
          <mat-card-header>
            <mat-card-title>
              {{card.fields.dataset_id}}
              <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu" xPosition="before">
                <button mat-menu-item>Expand</button>
                <button mat-menu-item>Remove</button>
              </mat-menu>
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="dashboard-card-content">
            <div>Number of records: {{card.fields.records_count}}</div>
            <div>Size of records: {{card.fields.records_size}}</div>
            <div>Last measure: {{card.fields.data_processed}}</div>
            <button mat-icon-button class="data-button" (click)="this.showTable(this.card.fields.dataset_id)"
              routerLink="table">
              <mat-icon>description</mat-icon>
            </button>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
    </mat-grid-list>
  </div>

  <div *ngIf="selected==='all'">
    <mat-grid-list cols="4">
      <mat-grid-tile *ngFor="let card of this.liste" [colspan]=1 [rowspan]=1>
        <mat-card class="dashboard-card">
          <mat-card-header>
            <mat-card-title>
              {{card.fields.dataset_id}}
              <button mat-icon-button class="more-button" [matMenuTriggerFor]="menu" aria-label="Toggle menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu" xPosition="before">
                <button mat-menu-item>Expand</button>
                <button mat-menu-item>Remove</button>
              </mat-menu>
            </mat-card-title>
          </mat-card-header>
          <mat-card-content class="dashboard-card-content">
            <div>Number of records: {{card.fields.records_count}}</div>
            <div>Size of records: {{card.fields.records_size}}</div>
            <div>Last measure: {{card.fields.data_processed}}</div>
            <button mat-icon-button class="data-button" (click)="this.showTable(this.card.fields.dataset_id)"
              routerLink="table">
              <mat-icon>description</mat-icon>
            </button>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
    </mat-grid-list>
  </div>
</div>

<!-- <p>{{this.obj}}</p> -->